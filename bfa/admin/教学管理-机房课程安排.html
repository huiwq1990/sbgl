<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>北京电影学院摄影系 - 教学管理</title>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="description" content="">
<meta name="author" content="">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link href="../css/bootstrap.css" rel="stylesheet" type="text/css" />
<link href="../css/global.css" rel="stylesheet" type="text/css" />

<!--[if lt IE 10]>
	<script src="../js/jquery.placeholder.js"></script>
	<script>
	$('input, textarea').placeholder();
	</script>
<![endif]-->
<!--[if lt IE 9]>
	<script src="../js/html5shiv.js"></script>
	<script src="../js/respond.min.js"></script>
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" href="css/font-awesome-ie7.min.css">
<![endif]-->
</head>

<body id="admin">
<header id="header-wrap"><!--header-wrap-->
	<div class="nav-wrap clearfix">
		<div class="site-nav">
			<div class="dropdown">
				<a class="pos dropdown-toggle" data-hover="dropdown" href="#"><i class="icon-home"></i> 管理中心 <i class="icon-chevron-right"></i></a><!-- #BeginLibraryItem "/Library/siteNav.lbi" --><ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
					<li><a href="../index.html"><i class="icon-home"></i> 首页</a></li>
					<li class="divider"></li>
					<li><a href="../预约首页.html">我的预约</a></li>
					<li><a href="../消息中心-站内信.html">站内信</a></li>
					<li class="divider"></li>
					<li><a href="../设置页面-账户设置.html">设置与帮助</a></li>
					<li><a href="管理中心首页.html">管理中心</a></li>
				</ul>
					<!-- #EndLibraryItem --></div>
		</div>
	<div class="sub-nav">
			<ul class="nav nav-tabs nav-tabs-google">
				<li><a href="管理中心首页.html">首页</a></li>
				<li class="active"><a href="教学管理首页.html">教学</a></li>
				<li><a href="用户管理首页.html">用户</a></li>
				<li><a href="设备预约首页.html">器材</a></li>
				<li><a href="机房预约管理首页.html">机房</a></li>
				<li><a href="#">内容</a></li>
			</ul>
		</div>
		<ul class="account-wrap nav nav-pills pull-right">
			<li class="notice dropdown">
				<a class="dropdown-toggle" data-toggle="dropdown" href="#"><i class="icon-bell icon-large"></i><span class="n-num label label-important">3</span></a>
				<ul class="dropdown-menu">
					<li><a href="#">消息1</a></li>
					<li><a href="#">消息2</a></li>
				</ul>
			</li>     
			<li class="social dropdown">
				<a href="#" class="dropdown-toggle" data-toggle="dropdown"><span class="username">陈诚</span><img src="../img/photo.jpg" width="32" height="32" class="img-circle"> <b class="caret"></b></a>
				<div class="dropdown-menu">
					<div class="media">
						<a class="pull-left" href="#">
							<img src="../img/photo.jpg" width="96" height="96" class="img-rounded">
						</a>
						<div class="media-body">
							<div class="media-heading"><h5><a href="#">陈诚</a></h5></div>
							<div class="info">2012级研究生 - 影像视觉效果研究方向</div>
							<div class="setting"><a href="#">账户设置</a></div>
							<button class="btn btn-primary" type="button">查看个人主页</button>
						</div>
					</div>
				</div>      
			</li>
		</ul>
	</div>
</header><!--/#header-wrap-->
<section id="main-wrap" class="clearfix"><!--main-wrap-->

			<!--admin-wrap start-->
			<div id="admin-wrap">
				<div id="admin-content" class="clearfix">    
					<!--control-bar start-->
					<div class="control-bar clearfix">
						<div class="title pull-left">机房课程安排</div>
						<div class="tips">布置教学任务后，指定的收件人将会收到教学预约通知，收件人在相关说明的指导下完成机房预约。</div>
					</div><!--control-bar end-->
					<div class="row">
						<div class="col-sm-12 col-md-3 col-lg-3">
							<div class="control-bar"><a href="#" class="btn btn-primary">添加</a></div>
							<div class="list-group">
								<a href="#" class="list-group-item">
									<h4 class="list-group-item-heading">全部课程</h4>
									<p class="list-group-item-text">浏览本学期全部课程</p>
								</a>
								<a href="#" class="list-group-item active">
									<h4 class="list-group-item-heading">课程名称</h4>
									<p class="list-group-item-text">任课教师：</p>
								</a>
								<a href="#" class="list-group-item">
									<h4 class="list-group-item-heading">课程名称</h4>
									<p class="list-group-item-text">任课教师：</p>
								</a>
							</div>
						</div>
						<div class="col-sm-12 col-md-9 col-lg-8">
							<div class="control-bar clearfix">
								<div class="title pull-left">课程名称</div>
								<div class="tips"><p>查看本门课程的行课安排或对行课安排进行调整。如果课程计划发生变更，请选中某个需要调整的时段，点击修改按钮完成课程安排的修改。如需添加新的行课安排，请选择某个时段后点击添加按钮。</p>
									<p><i class="icon-ok"></i> 表明该时段为本门课程的行课安排。</p>
									<p><i class="icon-warning-sign"></i> 表明该时段有其他课程正在使用机房资源，可能会发生冲突。</p>
								</div>
								<div class="row">
									<ul class="tab-drop nav nav-pills col-md-12">
										<li class="active"><a href="#ptab1" data-toggle="tab" data-week="1">第1周</a></li>
										<li><a href="#ptab2" data-toggle="tab" data-week="2">第2周</a></li>
										<li><a href="#ptab3" data-toggle="tab" data-week="3">第3周</a></li>
										<li><a href="#ptab4" data-toggle="tab" data-week="4">第4周</a></li>
										<li><a href="#ptab5" data-toggle="tab" data-week="5">第5周</a></li>
										<li><a href="#ptab6" data-toggle="tab" data-week="6">第6周</a></li>
										<li><a href="#ptab7" data-toggle="tab" data-week="7">第7周</a></li>
										<li><a href="#ptab8" data-toggle="tab" data-week="8">第8周</a></li>
										<li><a href="#ptab9" data-toggle="tab" data-week="9">第9周</a></li>
										<li><a href="#ptab10" data-toggle="tab" data-week="10">第10周</a></li>
										<li><a href="#ptab11" data-toggle="tab" data-week="11">第11周</a></li>
										<li><a href="#ptab12" data-toggle="tab" data-week="12">第12周</a></li>
										<li><a href="#ptab13" data-toggle="tab" data-week="13">第13周</a></li>
										<li><a href="#ptab14" data-toggle="tab" data-week="14">第14周</a></li>
										<li><a href="#ptab15" data-toggle="tab" data-week="15">第15周</a></li>
										<li><a href="#ptab16" data-toggle="tab" data-week="16">第16周</a></li>
										<li><a href="#ptab17" data-toggle="tab" data-week="17">第17周</a></li>                    
									</ul>
								</div>
							</div>
							<div class="panel panel-default">
								<table class="table table-btn-hover" id="course-week-table">
									<thead>
										<tr>
											<th class="time-slot" colspan="2">时间</th>
											<th>周一</th>
											<th>周二</th>
											<th>周三</th>
											<th>周四</th>
											<th>周五</th>
											<th>周六</th>
											<th>周日</th>                      
										</tr>
									</thead>
									<tbody>
										<tr id="tr-slot-1">
											<td class="time-slot" rowspan="2">上午</td>
											<td class="time-num">1</td>
											<td data-week="1" data-slot="1" data-is-planned="yes" class="selectable">
												<code><i class="icon-ok"></i></code>
											</td>
											<td data-week="2" data-slot="1" data-is-planned="no" class="selectable"></td>
											<td data-week="3" data-slot="1" data-is-planned="no" class="selectable">
												<code><i class="icon-warning-sign"></i></code>
											</td>
											<td data-week="4" data-slot="1" data-is-planned="no" class="selectable"></td>
											<td data-week="5" data-slot="1" data-is-planned="no" class="selectable"></td>
											<td data-week="6" data-slot="1" data-is-planned="no" class="selectable"></td>
											<td data-week="7" data-slot="1" data-is-planned="no" class="selectable"></td>
										</tr>
										<tr id="tr-slot-2">
											<td class="time-num">2</td>
											<td data-week="1" data-slot="2" data-is-planned="yes" class="selectable">
												<code><i class="icon-ok"></i></code>
											</td>
											<td data-week="2" data-slot="2" data-is-planned="no" class="selectable"></td>
											<td data-week="3" data-slot="2" data-is-planned="no" class="selectable">
												<code><i class="icon-warning-sign"></i></code>
											</td>
											<td data-week="4" data-slot="2" data-is-planned="no" class="selectable"></td>
											<td data-week="5" data-slot="2" data-is-planned="no" class="selectable"></td>
											<td data-week="6" data-slot="2" data-is-planned="no" class="selectable"></td>
											<td data-week="7" data-slot="2" data-is-planned="no" class="selectable"></td>
										</tr>
										<tr  id="tr-slot-3">
											<td rowspan="2" class="time-slot">下午</td>
											<td class="time-num">3</td>
											<td data-week="1" data-slot="3" data-is-planned="no" class="selectable"></td>
											<td data-week="2" data-slot="3" data-is-planned="no" class="selectable"></td>
											<td data-week="3" data-slot="3" data-is-planned="no" class="selectable"></td>
											<td data-week="4" data-slot="3" data-is-planned="yes" class="selectable">
												<code><i class="icon-ok"></i></code>
											</td>
											<td data-week="5" data-slot="3" data-is-planned="no" class="selectable"></td>
											<td data-week="6" data-slot="3" data-is-planned="no" class="selectable"></td>
											<td data-week="7" data-slot="3" data-is-planned="no" class="selectable"></td>
										</tr>
										<tr id="tr-slot-4">
											<td class="time-num">4</td>
											<td data-week="1" data-slot="4" data-is-planned="no" class="selectable"></td>
											<td data-week="2" data-slot="4" data-is-planned="no" class="selectable">
												<button class="btn btn-white btn-mini" type="button" rel="tooltip" data-title="您要在该时段添加本门课程的上课安排吗？" action-type="addNewArrange">添 加</button>
											</td>
											<td data-week="3" data-slot="4" data-is-planned="no" class="selectable"></td>
											<td data-week="4" data-slot="4" data-is-planned="yes" class="selectable">
												<code><i class="icon-ok"></i></code>
											</td>
											<td data-week="5" data-slot="4" data-is-planned="no" class="selectable"></td>
											<td data-week="6" data-slot="4" data-is-planned="no" class="selectable"></td>
											<td data-week="7" data-slot="4" data-is-planned="no" class="selectable"></td>
										</tr>
										<tr id="tr-slot-5">
											<td class="time-slot">晚上</td>
											<td class="time-num">5</td>
											<td data-week="1" data-slot="5" data-is-planned="no" class="selectable"></td>
											<td data-week="2" data-slot="5" data-is-planned="no" class="selectable"></td>
											<td data-week="3" data-slot="5" data-is-planned="no" class="selectable"></td>
											<td data-week="4" data-slot="5" data-is-planned="no" class="selectable"></td>
											<td data-week="5" data-slot="5" data-is-planned="no" class="selectable"></td>
											<td data-week="6" data-slot="5" data-is-planned="no" class="selectable"></td>
											<td data-week="7" data-slot="5" data-is-planned="no" class="selectable"></td>
										</tr>
									</tbody>
								</table><!-- /#course-week-table -->
								<div class="panel-footer" style="display: none;"><!-- panel-footer -->
									<h4>第XX周 星期X第X节课</h4>
									<div id="course-arrange-info" style="display: none;"><!-- #course-arrange-info -->
										<div id="is-planned-no" class="control-bar"  style="display: none;">
											<div class="tips">当前时段没有课程安排！您要在此时段添加本课程的上课安排吗？</div>
											<div class="btn-bar"><button class="btn btn-primary" type="button" action-type="addNewArrange">添 加</button></div>
										</div>
										<div id="is-planned-yes" class="control-bar"  style="display: none;">
											<div class="tips">以下是本门课程在所选时段所需的课程资源。</div>
											<div class="btn-bar">
												<button type="button" action-type="modifyCourseArrangement" class="btn btn-primary">修 改</button>
												<button class="btn btn-danger" type="button" action-type="cancelPlannedCourse">取消本节课</button>
											</div>                                  	
											<dl class="form-group dl-horizontal">
											    <dd>
											        <div class="group-hd">
											            <div class="group-name pull-left">工作站</div>
											            <div class="group-line"><hr></div>
											        </div>
													<ul class="list-inline">
														<li>MAC Pro工作站</li>
														<li>DELL工作站</li>
													</ul>
											        <div class="group-hd">
											            <div class="group-name pull-left">剪辑机房</div>
											            <div class="group-line"><hr></div>
											        </div>
													<ul class="list-inline">
														<li>剪辑机房1</li>
														<li>剪辑机房2</li>
														<li>剪辑机房3</li>
														<li>剪辑机房4</li>
														<li>……</li>
													</ul>
											        <div class="group-hd">
											            <div class="group-name pull-left">调色机房</div>
											            <div class="group-line"><hr></div>
											        </div>
													<ul class="list-inline">
														<li>达芬奇</li>
													</ul>
											    </dd>
											</dl>
										</div>
									</div><!-- /#course-arrange-info -->
									<div id="course-arrange-form" style="display: none;"><!-- #course-arrange-form -->
										<dl class="form-group dl-horizontal">
											<dt><label for="inputCourseNeed" class="control-label">所需课程资源</label></dt>
											<dd>
												<div class="group-hd">
													<div class="group-name pull-left">工作站</div>
													<div class="group-line"><hr></div>
												</div>
												<label class="checkbox-inline">
													<input type="checkbox" name="inputCourseNeed" id="CourseNeed1" value="1" checked="">MAC Pro工作站
												</label>
												<label class="checkbox-inline">
													<input type="checkbox" name="inputCourseNeed" id="CourseNeed2" value="2" checked="">DELL工作站
												</label>
												<div class="group-hd">
													<div class="group-name pull-left">剪辑机房</div>
													<div class="group-line"><hr></div>
												</div>
												<label class="checkbox-inline">
													<input type="checkbox" name="inputCourseNeed" id="inputCourseNeedEditor1" value="1" checked="">剪辑机房1
												</label>
												<label class="checkbox-inline">
													<input type="checkbox" name="inputCourseNeed" id="inputCourseNeedEditor2" value="2" checked="">剪辑机房2
												</label>
												<label class="checkbox-inline">
													<input type="checkbox" name="inputCourseNeed" id="inputCourseNeedEditor3" value="3" checked="">剪辑机房3
												</label>
												<label class="checkbox-inline">
													<input type="checkbox" name="inputCourseNeed" id="inputCourseNeedEditor4" value="4" checked="">剪辑机房4
												</label>
												<div class="group-hd">
													<div class="group-name pull-left">调色机房</div>
													<div class="group-line"><hr></div>
												</div>
												<label class="checkbox-inline">
													<input type="checkbox" name="inputCourseNeed" id="inputCourseNeedColor1" value="1" checked="">达芬奇
												</label>
												<label class="checkbox-inline">
													<input type="checkbox" name="inputCourseNeed" id="inputCourseNeedColor2" value="2" checked="">宽泰
												</label>
											</dd>
										</dl>
										<dl class="form-group dl-horizontal">
											<dd>
												<button type="button" action-type="saveModify" class="btn btn-primary">保 存</button>
												<button class="btn btn-danger" type="button" action-type="cancelPlannedCourse">取消本节课</button>
											</dd>
										</dl>
									</div><!-- /#course-arrange-form -->
								</div><!-- /.panel-footer -->
							</div>
						</div>
					</div>
				</div>
			</div>
			<!--equip-wrap end-->

			<!--sidebar start-->
			<div id="lside">
				<div class="list-group">
					<a href="教学管理首页.html" class="list-group-item">课程管理</a>
					<a href="教学管理-添加课程.html" class="list-group-item">添加课程</a>
					<a href="教学管理-设备预约安排.html" class="list-group-item">设备预约安排</a>
					<a href="教学管理-机房预约安排.html" class="list-group-item">机房预约安排</a>
					<a href="教学管理-机房课程安排.html" class="list-group-item active">机房课程安排</a>
			<a href="教学管理-教学设置.html" class="list-group-item">设置</a>
				</div>
			</div>
			<!--sidebar end-->

</section>


		<!-- javascript
		================================================== -->
<script src="../js/jquery.js"></script>
<script src="../js/loader.min.js"></script>
<script src="../js/select2.js"></script>
<script src="../js/bootstrap-hover-dropdown.min.js"></script>
<script src="../js/bfa.js"></script>
<script src="../js/bootstrap-tabdrop.js"></script>

<script>
$('.tab-drop.nav-pills').tabdrop();

/* ============ 课程安排 ============= */

/*$("body").on("click", "button[action-type|=modifyCourseArrangement]", function() {
	$(this).hide();
	$("button[action-type|=cancel]").show();
	$(".panel-footer").show();
	$("#course-week-table tbody td").each(function(index, element) {
		if ($(this).data("week") > 0) {
			$(this).addClass("selectable");
		}
	});
});*/

$("body").on("click", "button[action-type|=cancel]", function() {
	$(this).hide();
	$("button[action-type|=modifyCourseArrangement]").show();
	$(".panel-footer").hide();
	$("#course-week-table tbody td").each(function(index, element) {
		if ($(this).hasClass("selectable")) {
			$(this).removeClass("selectable");
		}
	});
});
// 提交课程变动。遍历课程表，获取课程变动情况（新增、取消和不变）
$("body").on('click', 'button[action-type|=saveModify]', function(event) {
	event.preventDefault();
	var hasNew       = false;
	var hasCanceled  = false;
	var newPlan      = new Array();
	var canceledPlan = new Array();
	var stillPlan = new Array();
	$("#course-week-table tbody td").each(function(index, el) {		// 遍历课程表
		var thisData = $(this).data();
		if ($(this).hasClass('selected') && thisData.isPlanned === "no") {		// 新课程安排
			newPlan.push(thisData);
			hasNew = true;
		} else if (!$(this).hasClass('selected') && thisData.isPlanned === "yes") {		// 取消原课程安排
			canceledPlan.push(thisData);
			hasCanceled = true;
		} else if ($(this).hasClass('selected') && thisData.isPlanned === "yes") {		// 不变的课程安排
			stillPlan.push(thisData);
		}
	});
	if (hasNew || hasCanceled) {
		if (hasNew) {
			alert("有新加的临时课程");
			alert(newPlan.join(";"));
			console.log(newPlan);
		}
		if (hasCanceled) {
			alert("有取消的课程");
			alert(canceledPlan.join(";"));
		}		
	} else {
		alert("无变化！");
	}
});

/*$("#course-week-table").on("click", ".selectable", function() {
	$(this).toggleClass("selected");
	if ($(this).hasClass("selected")) { // 如果选中
		$(this).append('<code><i class="icon-ok"></i></code>');
	} else {
		$(this).find("code").remove(); // 移除选中标识    
	}
});*/

var thisCourse;
var thisCourseData;
$("#course-week-table").on("click", "td.selectable", function() {
	alert("td.selectable")
	thisCourse = this;
	thisCourseData = $(this).data();
	$("#course-arrange-form button[action-type|=cancelPlannedCourse]").data(thisCourseData);
	console.log($("#course-arrange-form button[action-type|=cancelPlannedCourse]").data());
	$("#course-week-table td").removeClass("selected");
	$(this).addClass('selected');
	if (thisCourseData.isPlanned === "yes") {
		$("#is-planned-yes").show();
		$("#is-planned-no").hide();
	} else if (thisCourseData.isPlanned === "no") {
		$("#is-planned-no").show();
		$("#is-planned-yes").hide();
	}
	$(".panel-footer").show();
	$("#course-arrange-form").slideUp();
	$("#course-arrange-info").slideDown();
	$("button[action-type|=modifyCourseArrangement]").show();
	$("button[action-type|=cancelSelectedCourse]").show();

	// 这里加载当前选中的上课安排信息
	var weekStr = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六", "星期日"];
	var titleStr = "第X周 " + weekStr[thisCourseData.week] + " 第" + thisCourseData.slot + "节";	
	$(".panel-footer h4").html(titleStr);
	// 。。。。。。	
});

// 修改课程安排按钮
$("button[action-type|=modifyCourseArrangement]").on("click", function() {
	alert("modifyCourseArrangement")
	$("#course-arrange-info").slideUp();
	$("#course-arrange-form").slideDown();
	$("button[action-type|=cancelPlannedCourse]").show();
});
// 取消课程安排按钮
$("button[action-type|=cancelPlannedCourse]").on("click", function() {
	alert("cancelSelectedCourse")
	var thisCourse = $(this).parent("td");
	var thisCourseData = $(thisCourse).data();
	console.log(thisCourseData);
	$(thisCourse).removeClass("selected");
	$(thisCourse).find("code").remove(); // 移除选中标识
	$(thisCourse).find("button[action-type|=cancelPlannedCourse]").hide(); // 移除选中标识

	// 这里是取消当前选中的课程处理
	// 。。。。。。。。。
	// 
	// 重新加载课程表
	// 
	
});
// 添加新课程安排按钮
$("button[action-type|=addNewArrange]").on("click", function() {
	alert("addNewArrange")
	$("#course-week-table td").removeClass("selected");
	$(this).parent("td").addClass('selected');
	$(".panel-footer").show();
	$("#course-arrange-info").hide();
	$("#course-arrange-form").slideDown();
	$("#course-arrange-form button[action-type|=cancelPlannedCourse]").hide();
	// 清空处理表单
	// 
	// 

});
</script>
</body>
</html>